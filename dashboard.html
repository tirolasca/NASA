<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Planet Spotter — Dashboard</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body class="space-bg">
    <header class="header">
      <div class="logo">
        <div class="planet-icon"></div>
        <h1>Planet <span>Spotter</span></h1>
      </div>
      <nav class="nav-menu">
        <a href="index.html">Upload</a>
        <a href="dashboard.html">Dashboard</a>
      </nav>
    </header>

    <main class="container">
      <div class="dashboard-container">
        <section class="charts-block">
          <!-- Primeiro gráfico -->
          <div class="graph-block">
            <div class="card text-card">
              <span class="highlight">8540</span> entries analyzed
            </div>
            <div class="chart">
              <canvas id="chart1"></canvas>
              <p>
                <span class="highlight">6.3%</span> of the analyzed entries were
                confirmed as real exoplanets
              </p>
            </div>
            <div class="cards-block">
              <div class="card">
                <span class="highlight">540</span> inputs were real exoplanets
              </div>
              <div class="card">
                <span class="highlight">116</span> of these exoplanets have an
                atmosphere
              </div>
            </div>
          </div>

          <!-- Segundo gráfico -->
          <div class="graph-block">
            <div class="card text-card">
              <span class="highlight">338</span> stars with exoplanets
            </div>
            <div class="chart">
              <canvas id="chart2"></canvas>
              <p>
                In total, <span class="highlight">215</span> exoplanets (<span
                  class="highlight"
                  >39.8%</span
                >) are in the habitable zone
              </p>
            </div>
            <div class="cards-block">
              <div class="card">
                In total, <span class="highlight">338</span> different stars
                contain exoplanets
              </div>
              <div class="card">
                Each star contains an average of
                <span class="highlight">1.6</span> exoplanets
              </div>
            </div>
          </div>
        </section>

        <p class="note">
          If you wish, you can download the file with the analyzed data below.
        </p>
        <button class="download-btn">⬇ Download Data</button>
      </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
    <script>
      // Ajusta altura do gráfico conforme valores e tela
      function adjustChartHeight(chartId, dataset) {
        const chartContainer = document.getElementById(chartId).parentElement;
        const maxValue = Math.max(...dataset);
        const isMobile = window.innerWidth <= 600;
        const minHeight = isMobile ? 180 : 250;
        const maxHeight = isMobile ? 300 : 500;
        const scaleFactor = Math.min(maxValue / 100, 1);
        const newHeight = minHeight + (maxHeight - minHeight) * scaleFactor;
        chartContainer.style.height = newHeight + "px";
      }

      const data1 = [6.3, 93.7];
      const data2 = [39.8, 60.2];

      adjustChartHeight("chart1", data1);
      adjustChartHeight("chart2", data2);

      window.addEventListener("resize", () => {
        adjustChartHeight("chart1", data1);
        adjustChartHeight("chart2", data2);
      });

      const chartOptions = {
        responsive: true,
        maintainAspectRatio: false,
        cutout: "50%",
        plugins: {
          legend: { display: false },
          datalabels: {
            color: "#fff",
            font: { size: 14, weight: "bold" },
            formatter: (value, ctx) => {
              const sum = ctx.chart.data.datasets[0].data.reduce(
                (a, b) => a + b,
                0
              );
              return ((value / sum) * 100).toFixed(1) + "%";
            },
          },
        },
      };

      new Chart(document.getElementById("chart1"), {
        type: "doughnut",
        data: {
          labels: ["Exoplanets", "Others"],
          datasets: [
            {
              data: data1,
              backgroundColor: ["#ffb300", "#222844"],
              borderWidth: 0,
            },
          ],
        },
        options: chartOptions,
        plugins: [ChartDataLabels],
      });

      new Chart(document.getElementById("chart2"), {
        type: "doughnut",
        data: {
          labels: ["Habitable", "Non-habitable"],
          datasets: [
            {
              data: data2,
              backgroundColor: ["#ffb300", "#222844"],
              borderWidth: 0,
            },
          ],
        },
        options: chartOptions,
        plugins: [ChartDataLabels],
      });

      document.addEventListener("DOMContentLoaded", () =>
        document.body.classList.add("fade-in")
      );
    </script>
  </body>
</html>
